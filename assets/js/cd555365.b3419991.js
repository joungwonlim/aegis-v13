"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[283],{7944(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"guide/backend/data-layer","title":"Data Layer","description":"S0 Data Collection + S1 Universe","source":"@site/docs/guide/backend/data-layer.md","sourceDirName":"guide/backend","slug":"/guide/backend/data-layer","permalink":"/aegis-v13/docs/guide/backend/data-layer","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Data Layer","description":"S0 Data Collection + S1 Universe"},"sidebar":"guideSidebar","previous":{"title":"Folder Structure","permalink":"/aegis-v13/docs/guide/backend/folder-structure"},"next":{"title":"Signals Layer","permalink":"/aegis-v13/docs/guide/backend/signals-layer"}}');var r=t(4848),a=t(8453);const i={sidebar_position:2,title:"Data Layer",description:"S0 Data Collection + S1 Universe"},c="Data Layer",o={},l=[{value:"\uc5ed\ud560",id:"\uc5ed\ud560",level:2},{value:"\ud3f4\ub354 \uad6c\uc870",id:"\ud3f4\ub354-\uad6c\uc870",level:2},{value:"S0: Data Collection",id:"s0-data-collection",level:2},{value:"\uc218\uc9d1 \ub300\uc0c1 \ub370\uc774\ud130",id:"\uc218\uc9d1-\ub300\uc0c1-\ub370\uc774\ud130",level:3},{value:"\uc18c\uc2a4 \uc778\ud130\ud398\uc774\uc2a4",id:"\uc18c\uc2a4-\uc778\ud130\ud398\uc774\uc2a4",level:3},{value:"Naver Source \uad6c\ud604",id:"naver-source-\uad6c\ud604",level:3},{value:"\ud22c\uc790\uc790 \uc218\uae09 \uc218\uc9d1",id:"\ud22c\uc790\uc790-\uc218\uae09-\uc218\uc9d1",level:3},{value:"S0: Quality Gate",id:"s0-quality-gate",level:2},{value:"Contract",id:"contract",level:3},{value:"Quality Gate \uad6c\ud604",id:"quality-gate-\uad6c\ud604",level:3},{value:"S1: Universe Builder",id:"s1-universe-builder",level:2},{value:"Contract",id:"contract-1",level:3},{value:"Universe Builder \uad6c\ud604",id:"universe-builder-\uad6c\ud604",level:3},{value:"\uc124\uc815",id:"\uc124\uc815",level:2},{value:"\uc2a4\ucf00\uc904",id:"\uc2a4\ucf00\uc904",level:2},{value:"DB \uc2a4\ud0a4\ub9c8",id:"db-\uc2a4\ud0a4\ub9c8",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"data-layer",children:"Data Layer"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"S0: \ub370\uc774\ud130 \uc218\uc9d1/\ud488\uc9c8 + S1: \ud22c\uc790 \uc720\ub2c8\ubc84\uc2a4"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\uc5ed\ud560",children:"\uc5ed\ud560"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Stage"}),(0,r.jsx)(n.th,{children:"\uc5ed\ud560"}),(0,r.jsx)(n.th,{children:"\uc785\ub825"}),(0,r.jsx)(n.th,{children:"\ucd9c\ub825"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"S0"})}),(0,r.jsx)(n.td,{children:"\ub370\uc774\ud130 \uc218\uc9d1, \ud488\uc9c8 \uac80\uc99d"}),(0,r.jsx)(n.td,{children:"\uc678\ubd80 API"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"DataQualitySnapshot"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"S1"})}),(0,r.jsx)(n.td,{children:"\ud22c\uc790 \uac00\ub2a5 \uc885\ubaa9 \ud544\ud130\ub9c1"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"DataQualitySnapshot"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Universe"})})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\ub370\uc774\ud130 \uc694\uad6c\uc0ac\ud56d"}),": ",(0,r.jsx)(n.a,{href:"/aegis-v13/docs/guide/architecture/data-requirements",children:"Data Requirements"})," \ucc38\uc870"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\ud3f4\ub354-\uad6c\uc870",children:"\ud3f4\ub354 \uad6c\uc870"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"internal/\n\u251c\u2500\u2500 s0_data/\n\u2502   \u251c\u2500\u2500 sources/           # \ub370\uc774\ud130 \uc18c\uc2a4\ubcc4 \uc218\uc9d1\n\u2502   \u2502   \u251c\u2500\u2500 naver/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 client.go\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 prices.go       # \uac00\uaca9/\uac70\ub798\ub7c9\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 market_cap.go   # \uc2dc\uac00\ucd1d\uc561\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 fundamentals.go # \uc7ac\ubb34\uc81c\ud45c\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 investor.go     # \ud22c\uc790\uc790 \uc218\uae09\n\u2502   \u2502   \u251c\u2500\u2500 dart/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 client.go\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 disclosure.go   # \uacf5\uc2dc\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 financials.go   # \uc7ac\ubb34\uc81c\ud45c \uc0c1\uc138\n\u2502   \u2502   \u2514\u2500\u2500 krx/\n\u2502   \u2502       \u251c\u2500\u2500 client.go\n\u2502   \u2502       \u251c\u2500\u2500 stocks.go       # \uc885\ubaa9 \ub9c8\uc2a4\ud130\n\u2502   \u2502       \u2514\u2500\u2500 market.go       # \uc2dc\uc7a5 \uc9c0\ud45c\n\u2502   \u251c\u2500\u2500 quality/\n\u2502   \u2502   \u251c\u2500\u2500 validator.go        # \ub370\uc774\ud130 \uac80\uc99d\n\u2502   \u2502   \u2514\u2500\u2500 coverage.go         # \ucee4\ubc84\ub9ac\uc9c0 \uccb4\ud06c\n\u2502   \u251c\u2500\u2500 scheduler/\n\u2502   \u2502   \u251c\u2500\u2500 scheduler.go        # \uc218\uc9d1 \uc2a4\ucf00\uc904\ub7ec\n\u2502   \u2502   \u2514\u2500\u2500 job.go              # Job \uc815\uc758\n\u2502   \u251c\u2500\u2500 repository.go           # DB \uc800\uc7a5\n\u2502   \u2514\u2500\u2500 contract.go             # DataQualitySnapshot\n\u2502\n\u251c\u2500\u2500 s1_universe/\n\u2502   \u251c\u2500\u2500 builder.go              # Universe \uc0dd\uc131\n\u2502   \u251c\u2500\u2500 filters.go              # \ud544\ud130 \uc870\uac74\ub4e4\n\u2502   \u251c\u2500\u2500 repository.go           # DB \uc800\uc7a5\n\u2502   \u2514\u2500\u2500 contract.go             # Universe\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"s0-data-collection",children:"S0: Data Collection"}),"\n",(0,r.jsx)(n.h3,{id:"\uc218\uc9d1-\ub300\uc0c1-\ub370\uc774\ud130",children:"\uc218\uc9d1 \ub300\uc0c1 \ub370\uc774\ud130"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\ub370\uc774\ud130"}),(0,r.jsx)(n.th,{children:"\uc18c\uc2a4"}),(0,r.jsx)(n.th,{children:"\ucee4\ubc84\ub9ac\uc9c0 \ubaa9\ud45c"}),(0,r.jsx)(n.th,{children:"\uac31\uc2e0 \uc8fc\uae30"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\uac00\uaca9/\uac70\ub798\ub7c9"}),(0,r.jsx)(n.td,{children:"Naver"}),(0,r.jsx)(n.td,{children:"100%"}),(0,r.jsx)(n.td,{children:"Daily"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\uc2dc\uac00\ucd1d\uc561"}),(0,r.jsx)(n.td,{children:"Naver"}),(0,r.jsx)(n.td,{children:"95%+"}),(0,r.jsx)(n.td,{children:"Daily"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\ud22c\uc790\uc790 \uc218\uae09"}),(0,r.jsx)(n.td,{children:"Naver"}),(0,r.jsx)(n.td,{children:"80%+"}),(0,r.jsx)(n.td,{children:"Daily"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\uc7ac\ubb34\uc81c\ud45c"}),(0,r.jsx)(n.td,{children:"DART/Naver"}),(0,r.jsx)(n.td,{children:"80%+"}),(0,r.jsx)(n.td,{children:"Quarterly"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\ubc38\ub958\uc5d0\uc774\uc158"}),(0,r.jsx)(n.td,{children:"Naver/\uacc4\uc0b0"}),(0,r.jsx)(n.td,{children:"80%+"}),(0,r.jsx)(n.td,{children:"Daily"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\uacf5\uc2dc"}),(0,r.jsx)(n.td,{children:"DART"}),(0,r.jsx)(n.td,{children:"70%+"}),(0,r.jsx)(n.td,{children:"Real-time"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\uc885\ubaa9 \ub9c8\uc2a4\ud130"}),(0,r.jsx)(n.td,{children:"KRX"}),(0,r.jsx)(n.td,{children:"100%"}),(0,r.jsx)(n.td,{children:"Daily"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"\uc18c\uc2a4-\uc778\ud130\ud398\uc774\uc2a4",children:"\uc18c\uc2a4 \uc778\ud130\ud398\uc774\uc2a4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:"// internal/s0_data/sources/source.go\n\ntype DataSource interface {\n    Name() string\n    Fetch(ctx context.Context, opts FetchOptions) error\n}\n\ntype FetchOptions struct {\n    Symbols   []string   // \ud2b9\uc815 \uc885\ubaa9\ub9cc (nil = \uc804\uccb4)\n    DateFrom  time.Time\n    DateTo    time.Time\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"naver-source-\uad6c\ud604",children:"Naver Source \uad6c\ud604"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'// internal/s0_data/sources/naver/prices.go\n\ntype PriceSource struct {\n    client *NaverClient\n    repo   *repository.PriceRepository\n}\n\nfunc (s *PriceSource) Name() string { return "naver_prices" }\n\nfunc (s *PriceSource) Fetch(ctx context.Context, opts FetchOptions) error {\n    stocks := opts.Symbols\n    if len(stocks) == 0 {\n        stocks = s.repo.GetAllStockCodes(ctx)\n    }\n\n    for _, code := range stocks {\n        data, err := s.client.FetchOHLCV(ctx, code, opts.DateFrom, opts.DateTo)\n        if err != nil {\n            s.logger.Warn("fetch failed", "code", code, "error", err)\n            continue\n        }\n\n        if err := s.repo.SaveOHLCV(ctx, data); err != nil {\n            return fmt.Errorf("save OHLCV failed: %w", err)\n        }\n    }\n\n    return nil\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\ud22c\uc790\uc790-\uc218\uae09-\uc218\uc9d1",children:"\ud22c\uc790\uc790 \uc218\uae09 \uc218\uc9d1"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'// internal/s0_data/sources/naver/investor.go\n\ntype InvestorSource struct {\n    client *NaverClient\n    repo   *repository.InvestorRepository\n}\n\nfunc (s *InvestorSource) Fetch(ctx context.Context, opts FetchOptions) error {\n    stocks := opts.Symbols\n    if len(stocks) == 0 {\n        stocks = s.repo.GetAllStockCodes(ctx)\n    }\n\n    for _, code := range stocks {\n        flow, err := s.client.FetchInvestorFlow(ctx, code, opts.DateFrom, opts.DateTo)\n        if err != nil {\n            continue // \uc77c\ubd80 \uc885\ubaa9 \uc2e4\ud328 \ud5c8\uc6a9\n        }\n\n        if err := s.repo.SaveInvestorFlow(ctx, flow); err != nil {\n            return fmt.Errorf("save investor flow failed: %w", err)\n        }\n    }\n\n    return nil\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"s0-quality-gate",children:"S0: Quality Gate"}),"\n",(0,r.jsx)(n.h3,{id:"contract",children:"Contract"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'// internal/s0_data/contract.go\n\ntype DataQualitySnapshot struct {\n    Date         time.Time          `json:"date"`\n    TotalStocks  int                `json:"total_stocks"`\n    ValidStocks  int                `json:"valid_stocks"`\n    Coverage     DataCoverage       `json:"coverage"`\n    QualityScore float64            `json:"quality_score"`\n    Issues       []DataIssue        `json:"issues"`\n    PassedGate   bool               `json:"passed_gate"`\n}\n\ntype DataCoverage struct {\n    Price       float64 `json:"price"`        // \uac00\uaca9 \ucee4\ubc84\ub9ac\uc9c0\n    Volume      float64 `json:"volume"`       // \uac70\ub798\ub7c9 \ucee4\ubc84\ub9ac\uc9c0\n    MarketCap   float64 `json:"market_cap"`   // \uc2dc\uac00\ucd1d\uc561 \ucee4\ubc84\ub9ac\uc9c0\n    Financials  float64 `json:"financials"`   // \uc7ac\ubb34\uc81c\ud45c \ucee4\ubc84\ub9ac\uc9c0\n    Valuation   float64 `json:"valuation"`    // \ubc38\ub958\uc5d0\uc774\uc158 \ucee4\ubc84\ub9ac\uc9c0\n    Investor    float64 `json:"investor"`     // \uc218\uae09 \ucee4\ubc84\ub9ac\uc9c0\n    Disclosure  float64 `json:"disclosure"`   // \uacf5\uc2dc \ucee4\ubc84\ub9ac\uc9c0\n}\n\ntype DataIssue struct {\n    DataType    string `json:"data_type"`\n    StockCode   string `json:"stock_code"`\n    IssueType   string `json:"issue_type"`   // missing, outlier, stale\n    Description string `json:"description"`\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"quality-gate-\uad6c\ud604",children:"Quality Gate \uad6c\ud604"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'// internal/s0_data/quality/validator.go\n\ntype QualityGate struct {\n    db     *pgxpool.Pool\n    config QualityConfig\n}\n\ntype QualityConfig struct {\n    MinPriceCoverage     float64 `yaml:"min_price_coverage"`     // 1.0 (100%)\n    MinVolumeCoverage    float64 `yaml:"min_volume_coverage"`    // 1.0 (100%)\n    MinMarketCapCoverage float64 `yaml:"min_market_cap_coverage"` // 0.95\n    MinFinancialCoverage float64 `yaml:"min_financial_coverage"` // 0.80\n    MinInvestorCoverage  float64 `yaml:"min_investor_coverage"`  // 0.80\n    MinDisclosureCoverage float64 `yaml:"min_disclosure_coverage"` // 0.70\n}\n\nfunc (g *QualityGate) Check(ctx context.Context, date time.Time) (*DataQualitySnapshot, error) {\n    snapshot := &DataQualitySnapshot{\n        Date:   date,\n        Issues: make([]DataIssue, 0),\n    }\n\n    // 1. \uc804\uccb4 \uc885\ubaa9 \uc218\n    snapshot.TotalStocks = g.countTotalStocks(ctx)\n\n    // 2. \ucee4\ubc84\ub9ac\uc9c0 \uccb4\ud06c\n    snapshot.Coverage = DataCoverage{\n        Price:      g.checkCoverage(ctx, date, "price"),\n        Volume:     g.checkCoverage(ctx, date, "volume"),\n        MarketCap:  g.checkCoverage(ctx, date, "market_cap"),\n        Financials: g.checkCoverage(ctx, date, "financials"),\n        Valuation:  g.checkCoverage(ctx, date, "valuation"),\n        Investor:   g.checkCoverage(ctx, date, "investor"),\n        Disclosure: g.checkCoverage(ctx, date, "disclosure"),\n    }\n\n    // 3. \uc774\uc0c1\uce58 \ud0d0\uc9c0\n    snapshot.Issues = append(snapshot.Issues, g.detectOutliers(ctx, date)...)\n\n    // 4. \ud488\uc9c8 \uc810\uc218 \uacc4\uc0b0\n    snapshot.QualityScore = g.calculateScore(snapshot.Coverage)\n    snapshot.ValidStocks = int(float64(snapshot.TotalStocks) * snapshot.QualityScore)\n\n    // 5. Gate \ud1b5\uacfc \uc5ec\ubd80\n    snapshot.PassedGate = g.checkPassCriteria(snapshot.Coverage)\n\n    return snapshot, nil\n}\n\nfunc (g *QualityGate) checkPassCriteria(c DataCoverage) bool {\n    return c.Price >= g.config.MinPriceCoverage &&\n           c.Volume >= g.config.MinVolumeCoverage &&\n           c.MarketCap >= g.config.MinMarketCapCoverage &&\n           c.Financials >= g.config.MinFinancialCoverage &&\n           c.Investor >= g.config.MinInvestorCoverage\n    // Disclosure\ub294 \uc120\ud0dd\uc801\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"s1-universe-builder",children:"S1: Universe Builder"}),"\n",(0,r.jsx)(n.h3,{id:"contract-1",children:"Contract"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'// internal/s1_universe/contract.go\n\ntype Universe struct {\n    Date        time.Time            `json:"date"`\n    Stocks      []string             `json:"stocks"`      // \ud3ec\ud568 \uc885\ubaa9\n    Excluded    map[string]string    `json:"excluded"`    // \uc81c\uc678 \uc885\ubaa9: \uc0ac\uc720\n    TotalCount  int                  `json:"total_count"`\n    Config      UniverseConfig       `json:"config"`\n}\n\ntype UniverseConfig struct {\n    MinMarketCap   int64  `yaml:"min_market_cap"`    // \ucd5c\uc18c \uc2dc\ucd1d (\uc5b5)\n    MinVolume      int64  `yaml:"min_volume"`        // \ucd5c\uc18c \uac70\ub798\ub300\uae08 (\ubc31\ub9cc)\n    MinListingDays int    `yaml:"min_listing_days"`  // \ucd5c\uc18c \uc0c1\uc7a5\uc77c\uc218\n    ExcludeAdmin   bool   `yaml:"exclude_admin"`     // \uad00\ub9ac\uc885\ubaa9 \uc81c\uc678\n    ExcludeHalt    bool   `yaml:"exclude_halt"`      // \uac70\ub798\uc815\uc9c0 \uc81c\uc678\n    ExcludeSPAC    bool   `yaml:"exclude_spac"`      // SPAC \uc81c\uc678\n    ExcludeSectors []string `yaml:"exclude_sectors"` // \uc81c\uc678 \uc139\ud130\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"universe-builder-\uad6c\ud604",children:"Universe Builder \uad6c\ud604"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'// internal/s1_universe/builder.go\n\ntype UniverseBuilder struct {\n    db     *pgxpool.Pool\n    config UniverseConfig\n}\n\nfunc (b *UniverseBuilder) Build(ctx context.Context, snapshot *DataQualitySnapshot) (*Universe, error) {\n    if !snapshot.PassedGate {\n        return nil, fmt.Errorf("data quality gate not passed: score=%.2f", snapshot.QualityScore)\n    }\n\n    universe := &Universe{\n        Date:     snapshot.Date,\n        Stocks:   make([]string, 0),\n        Excluded: make(map[string]string),\n        Config:   b.config,\n    }\n\n    // \uc804\uccb4 \uc885\ubaa9 \uc870\ud68c\n    allStocks, err := b.getAllStocks(ctx)\n    if err != nil {\n        return nil, err\n    }\n\n    for _, stock := range allStocks {\n        reason := b.checkExclusion(ctx, stock)\n        if reason != "" {\n            universe.Excluded[stock.Code] = reason\n            continue\n        }\n        universe.Stocks = append(universe.Stocks, stock.Code)\n    }\n\n    universe.TotalCount = len(universe.Stocks)\n    return universe, nil\n}\n\nfunc (b *UniverseBuilder) checkExclusion(ctx context.Context, stock Stock) string {\n    // \uc6b0\uc120\uc21c\uc704 \uc21c\uc11c\ub85c \uccb4\ud06c\n    if b.config.ExcludeHalt && stock.IsHalted {\n        return "\uac70\ub798\uc815\uc9c0"\n    }\n    if b.config.ExcludeAdmin && stock.IsAdmin {\n        return "\uad00\ub9ac\uc885\ubaa9"\n    }\n    if b.config.ExcludeSPAC && stock.IsSPAC {\n        return "SPAC"\n    }\n    if stock.MarketCap < b.config.MinMarketCap*100_000_000 { // \uc5b5 \u2192 \uc6d0\n        return fmt.Sprintf("\uc2dc\uac00\ucd1d\uc561 \ubbf8\ub2ec (%d\uc5b5)", stock.MarketCap/100_000_000)\n    }\n    if stock.AvgVolume < b.config.MinVolume*1_000_000 { // \ubc31\ub9cc \u2192 \uc6d0\n        return fmt.Sprintf("\uac70\ub798\ub300\uae08 \ubbf8\ub2ec (%d\ubc31\ub9cc)", stock.AvgVolume/1_000_000)\n    }\n    if stock.ListingDays < b.config.MinListingDays {\n        return fmt.Sprintf("\uc0c1\uc7a5\uc77c\uc218 \ubbf8\ub2ec (%d\uc77c)", stock.ListingDays)\n    }\n    for _, sector := range b.config.ExcludeSectors {\n        if stock.Sector == sector {\n            return fmt.Sprintf("\uc81c\uc678 \uc139\ud130 (%s)", sector)\n        }\n    }\n    return "" // \ud1b5\uacfc\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\uc124\uc815",children:"\uc124\uc815"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# config/data.yaml\n\n# S0: \ub370\uc774\ud130 \uc218\uc9d1\ndata:\n  sources:\n    naver:\n      rate_limit: 10  # requests per second\n      timeout: 30s\n    dart:\n      api_key: ${DART_API_KEY}\n      rate_limit: 100  # requests per minute\n    krx:\n      timeout: 60s\n\n  quality:\n    min_price_coverage: 1.0\n    min_volume_coverage: 1.0\n    min_market_cap_coverage: 0.95\n    min_financial_coverage: 0.80\n    min_investor_coverage: 0.80\n    min_disclosure_coverage: 0.70\n\n# S1: \uc720\ub2c8\ubc84\uc2a4\nuniverse:\n  min_market_cap: 1000      # 1000\uc5b5 \uc774\uc0c1\n  min_volume: 500           # 5\uc5b5 \uc774\uc0c1\n  min_listing_days: 90      # \uc0c1\uc7a5 90\uc77c \uc774\uc0c1\n  exclude_admin: true\n  exclude_halt: true\n  exclude_spac: true\n  exclude_sectors:\n    - "\uae08\uc735"\n    - "\ubcf4\ud5d8"\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\uc2a4\ucf00\uc904",children:"\uc2a4\ucf00\uc904"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\uc791\uc5c5"}),(0,r.jsx)(n.th,{children:"\uc2dc\uac04"}),(0,r.jsx)(n.th,{children:"\uc124\uba85"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\uc885\ubaa9 \ub9c8\uc2a4\ud130"}),(0,r.jsx)(n.td,{children:"08:00"}),(0,r.jsx)(n.td,{children:"\uc7a5 \uc2dc\uc791 \uc804"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\uac00\uaca9/\uac70\ub798\ub7c9"}),(0,r.jsx)(n.td,{children:"15:45"}),(0,r.jsx)(n.td,{children:"\uc7a5 \ub9c8\uac10 \ud6c4"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\uc2dc\uac00\ucd1d\uc561"}),(0,r.jsx)(n.td,{children:"15:50"}),(0,r.jsx)(n.td,{children:"\uac00\uaca9 \uc218\uc9d1 \ud6c4"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\ud22c\uc790\uc790 \uc218\uae09"}),(0,r.jsx)(n.td,{children:"16:05"}),(0,r.jsx)(n.td,{children:"\uc9d1\uacc4 \uc644\ub8cc \ud6c4"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\ud488\uc9c8 \uccb4\ud06c"}),(0,r.jsx)(n.td,{children:"16:30"}),(0,r.jsx)(n.td,{children:"\uc218\uc9d1 \uc644\ub8cc \ud6c4"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Universe \uc0dd\uc131"}),(0,r.jsx)(n.td,{children:"16:35"}),(0,r.jsx)(n.td,{children:"\ud488\uc9c8 \ud1b5\uacfc \ud6c4"})]})]})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'// internal/s0_data/scheduler/scheduler.go\n\ntype DailySchedule struct {\n    tasks []ScheduledTask\n}\n\nfunc DefaultDailySchedule() *DailySchedule {\n    return &DailySchedule{\n        tasks: []ScheduledTask{\n            {Time: "08:00", Task: "stocks"},\n            {Time: "15:45", Task: "prices"},\n            {Time: "15:50", Task: "market_cap"},\n            {Time: "16:05", Task: "investor"},\n            {Time: "16:30", Task: "quality_check"},\n            {Time: "16:35", Task: "universe_build"},\n        },\n    }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"db-\uc2a4\ud0a4\ub9c8",children:"DB \uc2a4\ud0a4\ub9c8"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- \ub370\uc774\ud130 \uc2a4\ud0a4\ub9c8\nCREATE SCHEMA IF NOT EXISTS data;\n\n-- \uac00\uaca9 \ub370\uc774\ud130\nCREATE TABLE data.prices (\n    stock_code  VARCHAR(10) NOT NULL,\n    date        DATE NOT NULL,\n    open        BIGINT,\n    high        BIGINT,\n    low         BIGINT,\n    close       BIGINT NOT NULL,\n    volume      BIGINT,\n    value       BIGINT,\n    adj_close   DECIMAL(15,2),\n    adj_factor  DECIMAL(10,6) DEFAULT 1.0,\n    created_at  TIMESTAMPTZ DEFAULT NOW(),\n    PRIMARY KEY (stock_code, date)\n);\n\n-- \ud22c\uc790\uc790 \uc218\uae09\nCREATE TABLE data.investor_flow (\n    stock_code    VARCHAR(10) NOT NULL,\n    date          DATE NOT NULL,\n    foreign_net   BIGINT,      -- \uc678\uad6d\uc778 \uc21c\ub9e4\uc218\n    inst_net      BIGINT,      -- \uae30\uad00 \uc21c\ub9e4\uc218\n    individual_net BIGINT,     -- \uac1c\uc778 \uc21c\ub9e4\uc218\n    financial_net BIGINT,      -- \uae08\uc735\ud22c\uc790\n    insurance_net BIGINT,      -- \ubcf4\ud5d8\n    trust_net     BIGINT,      -- \ud22c\uc2e0\n    pension_net   BIGINT,      -- \uc5f0\uae30\uae08\n    created_at    TIMESTAMPTZ DEFAULT NOW(),\n    PRIMARY KEY (stock_code, date)\n);\n\n-- \ud488\uc9c8 \uc2a4\ub0c5\uc0f7\nCREATE TABLE data.quality_snapshots (\n    id            SERIAL PRIMARY KEY,\n    date          DATE NOT NULL UNIQUE,\n    total_stocks  INT,\n    valid_stocks  INT,\n    coverage      JSONB,\n    quality_score DECIMAL(5,4),\n    passed_gate   BOOLEAN,\n    issues        JSONB,\n    created_at    TIMESTAMPTZ DEFAULT NOW()\n);\n\n-- \uc720\ub2c8\ubc84\uc2a4 \uc2a4\ub0c5\uc0f7\nCREATE TABLE data.universe_snapshots (\n    id          SERIAL PRIMARY KEY,\n    date        DATE NOT NULL UNIQUE,\n    stocks      TEXT[],\n    excluded    JSONB,\n    total_count INT,\n    config      JSONB,\n    created_at  TIMESTAMPTZ DEFAULT NOW()\n);\n\n-- \uc778\ub371\uc2a4\nCREATE INDEX idx_prices_date ON data.prices(date);\nCREATE INDEX idx_investor_flow_date ON data.investor_flow(date);\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Prev"}),": ",(0,r.jsx)(n.a,{href:"/aegis-v13/docs/guide/backend/folder-structure",children:"Folder Structure"}),"\n",(0,r.jsx)(n.strong,{children:"Next"}),": ",(0,r.jsx)(n.a,{href:"/aegis-v13/docs/guide/backend/signals-layer",children:"Signals Layer"})]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>i,x:()=>c});var s=t(6540);const r={},a=s.createContext(r);function i(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);