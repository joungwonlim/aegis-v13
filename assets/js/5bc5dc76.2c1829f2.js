"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[870],{3637(n,e,r){r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"guide/backend/selection-layer","title":"Selection Layer","description":"S3-S4 \uc2a4\ud06c\ub9ac\ub2dd/\ub7ad\ud0b9","source":"@site/docs/guide/backend/selection-layer.md","sourceDirName":"guide/backend","slug":"/guide/backend/selection-layer","permalink":"/aegis-v13/docs/guide/backend/selection-layer","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Selection Layer","description":"S3-S4 \uc2a4\ud06c\ub9ac\ub2dd/\ub7ad\ud0b9"},"sidebar":"guideSidebar","previous":{"title":"Signals Layer","permalink":"/aegis-v13/docs/guide/backend/signals-layer"},"next":{"title":"Portfolio Layer","permalink":"/aegis-v13/docs/guide/backend/portfolio-layer"}}');var a=r(4848),i=r(8453);const l={sidebar_position:4,title:"Selection Layer",description:"S3-S4 \uc2a4\ud06c\ub9ac\ub2dd/\ub7ad\ud0b9"},s="Selection Layer",c={},o=[{value:"\ucc45\uc784",id:"\ucc45\uc784",level:2},{value:"\ud3f4\ub354 \uad6c\uc870",id:"\ud3f4\ub354-\uad6c\uc870",level:2},{value:"S3: Screener",id:"s3-screener",level:2},{value:"\ubaa9\uc801",id:"\ubaa9\uc801",level:3},{value:"\uc778\ud130\ud398\uc774\uc2a4",id:"\uc778\ud130\ud398\uc774\uc2a4",level:3},{value:"\uad6c\ud604",id:"\uad6c\ud604",level:3},{value:"S4: Ranker",id:"s4-ranker",level:2},{value:"\uc778\ud130\ud398\uc774\uc2a4",id:"\uc778\ud130\ud398\uc774\uc2a4-1",level:3},{value:"\uad6c\ud604",id:"\uad6c\ud604-1",level:3},{value:"\uc124\uc815 \uc608\uc2dc (YAML)",id:"\uc124\uc815-\uc608\uc2dc-yaml",level:2},{value:"\uc2a4\ud06c\ub9ac\ub2dd \ub2e8\uacc4\ubcc4 \ud6a8\uacfc",id:"\uc2a4\ud06c\ub9ac\ub2dd-\ub2e8\uacc4\ubcc4-\ud6a8\uacfc",level:2},{value:"DB \uc2a4\ud0a4\ub9c8",id:"db-\uc2a4\ud0a4\ub9c8",level:2}];function d(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"selection-layer",children:"Selection Layer"})}),"\n",(0,a.jsxs)(e.blockquote,{children:["\n",(0,a.jsx)(e.p,{children:"S3: Screener + S4: Ranker"}),"\n"]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"\ucc45\uc784",children:"\ucc45\uc784"}),"\n",(0,a.jsxs)(e.table,{children:[(0,a.jsx)(e.thead,{children:(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.th,{children:"Stage"}),(0,a.jsx)(e.th,{children:"\uc5ed\ud560"}),(0,a.jsx)(e.th,{children:"\ubaa9\uc801"})]})}),(0,a.jsxs)(e.tbody,{children:[(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"S3"}),(0,a.jsx)(e.td,{children:"Hard Cut \ud544\ud130\ub9c1"}),(0,a.jsx)(e.td,{children:"AI \ube44\uc6a9 \uc808\uac10 (90% \uc81c\uac70)"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"S4"}),(0,a.jsx)(e.td,{children:"\uc885\ud569 \uc810\uc218 \uc0b0\ucd9c"}),(0,a.jsx)(e.td,{children:"Top N \uc120\ubcc4"})]})]})]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"\ud3f4\ub354-\uad6c\uc870",children:"\ud3f4\ub354 \uad6c\uc870"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"internal/selection/\n\u251c\u2500\u2500 screener.go     # Screener \uad6c\ud604\n\u251c\u2500\u2500 ranker.go       # Ranker \uad6c\ud604\n\u2514\u2500\u2500 config.go       # \uc124\uc815 \ub85c\ub354\n"})}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"s3-screener",children:"S3: Screener"}),"\n",(0,a.jsx)(e.h3,{id:"\ubaa9\uc801",children:"\ubaa9\uc801"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"AI \ubd84\uc11d \uc804 \ube60\ub978 \ud544\ud130\ub9c1"}),"\uc73c\ub85c \ube44\uc6a9 \uc808\uac10"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"1000\uac1c \uc885\ubaa9 \u2192 Screener \u2192 100\uac1c \u2192 AI \ubd84\uc11d\n                (90% \uc81c\uac70)\n"})}),"\n",(0,a.jsx)(e.h3,{id:"\uc778\ud130\ud398\uc774\uc2a4",children:"\uc778\ud130\ud398\uc774\uc2a4"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-go",children:"type Screener interface {\n    Screen(ctx context.Context, signals *SignalSet) ([]string, error)\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"\uad6c\ud604",children:"\uad6c\ud604"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-go",children:'// internal/selection/screener.go\n\ntype screener struct {\n    config ScreenerConfig\n}\n\ntype ScreenerConfig struct {\n    // Hard Cut \uc870\uac74\n    MinMomentum  float64 `yaml:"min_momentum"`   // -1.0 \uc774\uc0c1\n    MinVolume    int64   `yaml:"min_volume"`     // 5\uc5b5 \uc774\uc0c1\n    MaxPER       float64 `yaml:"max_per"`        // 50 \uc774\ud558\n    MinROE       float64 `yaml:"min_roe"`        // 5% \uc774\uc0c1\n\n    // Negative \ud544\ud130\n    ExcludeNegativeEarnings bool `yaml:"exclude_negative_earnings"`\n}\n\nfunc (s *screener) Screen(ctx context.Context, signals *contracts.SignalSet) ([]string, error) {\n    passed := make([]string, 0)\n\n    for code, signal := range signals.Signals {\n        if s.passAllConditions(signal) {\n            passed = append(passed, code)\n        }\n    }\n\n    return passed, nil\n}\n\nfunc (s *screener) passAllConditions(signal contracts.StockSignal) bool {\n    // \ubaa8\uba58\ud140 \ud544\ud130\n    if signal.Factors["momentum"] < s.config.MinMomentum {\n        return false\n    }\n\n    // PER \ud544\ud130\n    if per := signal.Factors["per"]; per > s.config.MaxPER || per < 0 {\n        return false\n    }\n\n    // ROE \ud544\ud130\n    if signal.Factors["roe"] < s.config.MinROE {\n        return false\n    }\n\n    return true\n}\n'})}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"s4-ranker",children:"S4: Ranker"}),"\n",(0,a.jsx)(e.h3,{id:"\uc778\ud130\ud398\uc774\uc2a4-1",children:"\uc778\ud130\ud398\uc774\uc2a4"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-go",children:"type Ranker interface {\n    Rank(ctx context.Context, codes []string, signals *SignalSet) ([]RankedStock, error)\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"\uad6c\ud604-1",children:"\uad6c\ud604"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-go",children:'// internal/selection/ranker.go\n\ntype ranker struct {\n    weights WeightConfig\n}\n\ntype WeightConfig struct {\n    Momentum  float64 `yaml:"momentum"`   // 0.25\n    Technical float64 `yaml:"technical"`  // 0.15\n    Value     float64 `yaml:"value"`      // 0.20\n    Quality   float64 `yaml:"quality"`    // 0.15\n    Flow      float64 `yaml:"flow"`       // 0.20 \u2b50 \uc218\uae09\n    Event     float64 `yaml:"event"`      // 0.05\n}\n\nfunc (r *ranker) Rank(ctx context.Context, codes []string, signals *contracts.SignalSet) ([]contracts.RankedStock, error) {\n    ranked := make([]contracts.RankedStock, 0, len(codes))\n\n    for _, code := range codes {\n        signal := signals.Signals[code]\n\n        // \uac00\uc911 \ud569\uc0b0 (SSOT: data-flow.md \uae30\uc900)\n        totalScore :=\n            signal.Momentum * r.weights.Momentum +      // 25%\n            signal.Technical * r.weights.Technical +    // 15%\n            signal.Value * r.weights.Value +            // 20%\n            signal.Quality * r.weights.Quality +        // 15%\n            signal.Flow * r.weights.Flow +              // 20% \u2b50\n            signal.Event * r.weights.Event              // 5%\n\n        ranked = append(ranked, contracts.RankedStock{\n            Code:       code,\n            TotalScore: totalScore,\n            Scores: contracts.ScoreDetail{\n                Momentum:  signal.Momentum,\n                Technical: signal.Technical,\n                Value:     signal.Value,\n                Quality:   signal.Quality,\n                Flow:      signal.Flow,\n                Event:     signal.Event,\n            },\n        })\n    }\n\n    // \uc810\uc218 \ub0b4\ub9bc\ucc28\uc21c \uc815\ub82c\n    sort.Slice(ranked, func(i, j int) bool {\n        return ranked[i].TotalScore > ranked[j].TotalScore\n    })\n\n    // \uc21c\uc704 \ubd80\uc5ec\n    for i := range ranked {\n        ranked[i].Rank = i + 1\n    }\n\n    return ranked, nil\n}\n'})}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"\uc124\uc815-\uc608\uc2dc-yaml",children:"\uc124\uc815 \uc608\uc2dc (YAML)"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-yaml",children:"# config/selection.yaml\n\nscreener:\n  min_momentum: -1.0\n  min_volume: 500000000    # 5\uc5b5\n  max_per: 50\n  min_roe: 0.05\n  exclude_negative_earnings: true\n\nranker:\n  weights:\n    momentum: 0.25\n    technical: 0.15\n    value: 0.20\n    quality: 0.15\n    flow: 0.20       # \uc218\uae09 \u2b50\n    event: 0.05\n\n  # Top N \uc120\ud0dd\n  top_n: 30\n"})}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"\uc2a4\ud06c\ub9ac\ub2dd-\ub2e8\uacc4\ubcc4-\ud6a8\uacfc",children:"\uc2a4\ud06c\ub9ac\ub2dd \ub2e8\uacc4\ubcc4 \ud6a8\uacfc"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \uc804\uccb4 \uc885\ubaa9                          2,500\uac1c  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 S1: Universe (\uac70\ub798\uc815\uc9c0/\uad00\ub9ac\uc885\ubaa9 \uc81c\uc678)  2,000\uac1c  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 S3: Screener                               \u2502\n\u2502   - \uc2dc\ucd1d \ud544\ud130                       1,500\uac1c  \u2502\n\u2502   - \uac70\ub798\ub300\uae08 \ud544\ud130                   1,000\uac1c  \u2502\n\u2502   - \ubaa8\uba58\ud140 \ud544\ud130                      500\uac1c  \u2502\n\u2502   - \uc7ac\ubb34 \ud544\ud130                        200\uac1c  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 S4: Ranker (Top 30)                   30\uac1c  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"AI \ube44\uc6a9 \uc808\uac10"}),": 2,500\uac1c \u2192 30\uac1c = ",(0,a.jsx)(e.strong,{children:"99% \uac10\uc18c"})]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"db-\uc2a4\ud0a4\ub9c8",children:"DB \uc2a4\ud0a4\ub9c8"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sql",children:"-- selection.screened: \uc2a4\ud06c\ub9ac\ub2dd \uacb0\uacfc\nCREATE TABLE selection.screened (\n    id          SERIAL PRIMARY KEY,\n    date        DATE NOT NULL,\n    passed      TEXT[],         -- \ud1b5\uacfc \uc885\ubaa9\n    filtered    JSONB,          -- \ud544\ud130\ubcc4 \uc81c\uc678 \uc218\n    total_input INT,\n    total_passed INT,\n    created_at  TIMESTAMPTZ DEFAULT NOW()\n);\n\n-- selection.ranked: \ub7ad\ud0b9 \uacb0\uacfc\nCREATE TABLE selection.ranked (\n    id          SERIAL PRIMARY KEY,\n    date        DATE NOT NULL,\n    code        VARCHAR(10) NOT NULL,\n    rank        INT NOT NULL,\n    total_score DECIMAL(8,4),\n    factors     JSONB,\n    created_at  TIMESTAMPTZ DEFAULT NOW(),\n    UNIQUE(date, code)\n);\n\nCREATE INDEX idx_ranked_date_rank ON selection.ranked(date, rank);\n"})}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Prev"}),": ",(0,a.jsx)(e.a,{href:"/aegis-v13/docs/guide/backend/signals-layer",children:"Signals Layer"}),"\n",(0,a.jsx)(e.strong,{children:"Next"}),": ",(0,a.jsx)(e.a,{href:"/aegis-v13/docs/guide/backend/portfolio-layer",children:"Portfolio Layer"})]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(d,{...n})}):d(n)}},8453(n,e,r){r.d(e,{R:()=>l,x:()=>s});var t=r(6540);const a={},i=t.createContext(a);function l(n){const e=t.useContext(i);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:l(n.components),t.createElement(i.Provider,{value:e},n.children)}}}]);